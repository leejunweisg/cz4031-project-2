{% extends "outline.html" %}

{% block title %}CZ4031 Project 2{% endblock title %}

{% block css %}
  <link rel="stylesheet" href="../static/css/Treant.css" type="text/css"/>
{% endblock css %}

{% block body %}


  <div class="section p-0">


    <div class="container">
      <h1 class="title mb-5">AQP Visualiser</h1>

      <div class="row">
        <div class="col-lg-6">
          <div class="card">
            <div class="card-body">
              <h3 class="card-title font-weight-bold">Query</h3>
              <h6 class="card-subtitle mt-2 text-muted">Enter your SQL query here!</h6>
              <form method="POST">
                <div class="form-group">
                  <label for="id-query"> </label>
                  <textarea class="form-control form-control-success" id="id-query" placeholder="SELECT * FROM USERS;"
                            name="query"
                            style="font-size:1.3em" required></textarea>
                </div>
                <div class="float-right">
                  <button class="btn btn-primary">Go!</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div class="col-lg-6">
          <div class="card">
            <div class="card-body">
              <h3 class="card-title font-weight-bold">Results</h3>
              <ul class="nav nav-tabs nav-tabs-primary" role="tablist">
                <!-- Tab-buttons for each plan -->
                {% for idx in range(1, 4) %}
                  <li class="nav-item">
                    <a class="nav-link{% if idx==1 %} active show{% endif %}" data-toggle="tab" href="#plan{{ idx }}" role="tablist">
                      Plan {{ idx }}
                    </a>
                  </li>
                {% endfor %}

              </ul>
              <div class="tab-content tab-space pb-2">
                <!-- Tab-panes for each plan -->
                {% for idx in range(1, 4) %}
                  <!-- Plan {{ idx }} -->
                  <div class="tab-pane{% if idx==1 %} active show{% endif %}" id="plan{{ idx }}">
                    <!-- Metrics row -->
                    <div class="row">
                      <div class="col-md-12">
                        <h4>Metrics</h4>
                      </div>
                      <div class="col-md-3">
                        <h5 class="font-weight-bold mb-1">Cost</h5>
                        <p>156.12</p>
                      </div>
                      <div class="col-md-3">
                        <h5 class="font-weight-bold mb-1">Joins</h5>
                        <p>5 joins</p>
                      </div>
                      <div class="col-md-3">
                        <h5 class="font-weight-bold mb-1">Joins</h5>
                        <p>5 joins</p>
                      </div>
                      <div class="col-md-3">
                        <h5 class="font-weight-bold mb-1">Joins</h5>
                        <p>5 joins</p>
                      </div>
                    </div>

                    <!-- Description row -->
                    <div class="row mt-3">
                      <div class="col-md-12">
                        <h4>Description</h4>
                        <p>
                          First, a join is done on the xxx table and bla bla black sheep I don't know what else to
                          write.
                          Next, a index scan is performed on the. First, a join is done on the xxx table and bla bla
                          black
                          sheep I don't know what else to write.
                          Next, a index scan is performed on the.
                        </p>
                      </div>
                    </div>

                    <!-- Graph row -->
                    <div class="row mt-3">
                      <div class="col-md-12">
                        <h4>Graph</h4>
                        <div id="graph-{{ idx }}"></div>
                        <button class="btn btn-sm btn-info" onclick="generateGraph(this, {{ idx }})">Display graph
                        </button>
                      </div>
                    </div>
                  </div>
                {% endfor %}

              </div>
            </div>
          </div>
        </div>

      </div>

    </div>
  </div>

{% endblock body %}

{% block js %}
  <script src="../static/js/plugins/raphael.js"></script>
  <script src="../static/js/plugins/Treant.js"></script>
  <script>
      const generateGraph = (btn, idx) => {
          btn.style.display = 'none';
          switch (idx) {
              case 1:
                  Treant({
                      chart: {
                          container: "#graph-1"
                      },
                      nodeStructure: {
                          text: {name: "Parent node"},
                          children: [
                              {
                                  text: {name: "First child"}
                              },
                              {
                                  text: {name: "Second child"}
                              }
                          ]
                      }
                  }, function () {
                  }, $);
                  break;
              case 2:
                  Treant({
                      chart: {
                          container: "#graph-2"
                      },
                      nodeStructure: {
                          text: {name: "Parent node"},
                          children: [
                              {
                                  text: {name: "First child"}
                              },
                              {
                                  text: {name: "Second child"}
                              }
                          ]
                      }
                  }, function () {
                  }, $);
                  break;
              case 3:
                  Treant({
                      chart: {
                          container: "#graph-3"
                      },
                      nodeStructure: {
                          text: {name: "Parent node"},
                          children: [
                              {
                                  text: {name: "First child"}
                              },
                              {
                                  text: {name: "Second child"}
                              }
                          ]
                      }
                  }, function () {
                  }, $);
                  break;
              default:
                  alert("Could not generate graph!");
          }
      }
  </script>

{% endblock js %}